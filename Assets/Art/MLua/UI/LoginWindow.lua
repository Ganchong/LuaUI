---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 干冲.
--- DateTime: 2018/3/24 19:06
---
LoginWindow = class("LoginWindow", WindowBase)

local this = LoginWindow

function this:InitUI(uiObj)
    self.UIObj = uiObj
    self:BindWindow(uiObj)
    self:AddButtonEvent()
    Log("LoginWindow InitUI")
end

function this:BindWindow(uiObj)
    self.TimeLabel = LuaUtil.GetChildComponent(uiObj,"root/time",ComponentName.UIText)
    self.LoginButton = LuaUtil.GetChildComponent(uiObj,"root/LoginButton",ComponentName.UIButton)
    self.LoginText = LuaUtil.GetChildComponent(uiObj,"root/LoginButton/Text",ComponentName.UIText)
    self.LoginImage = LuaUtil.GetChildComponent(uiObj,"root/LoginButton",ComponentName.UIImage)
    self.back = LuaUtil.GetChildComponent(uiObj,"back",ComponentName.UIRawImage)
end

function this:AddButtonEvent()
    self.LoginButton.onClick:AddListener(function() self:LoginEvent() end)
    LuaAPP.GetGlobalEvent():AddEvent(EventName.LoginEvent1,
            function () LuaAPP.GetUIManager():OpenWindow(WindowName.Alert,
                function ()
                    LuaAPP.GetUIManager():OpenWindow(WindowName.CreateRoleWindow)
                end,"go to create a role?")
            end
    )
end

function this:LoginEvent()
    LuaAPP.GetGlobalEvent():DispatchEvent(EventName.LoginEvent1)
    --LuaAPP.GetUIManager():OpenWindow("Alert","")
end

function this:OnEnableUI(param)
    LuaAPP.GetBackGroundManager():Change("loginBack")
    self.timer = self:NewTimer()
    self.timer:AddOnTimer(function () self:UpdateTime() end)
    self.timer:Start(true)
    self.LoginButton:SetGray(true)
    --self.LoginButton:SetGray(false)
end

function this:UpdateTime()
    self.TimeLabel.text = Util.TimeToString_02(Time.GetTimestamp())
end

function this:Update()
    --self.TimeLabel.text = Util.TimeToString_02(Time.GetTimestamp())
end

function this:GetUIType()
    return WindowType.FullType
end
return this

